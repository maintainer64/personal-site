---
title: "Умные шторы"
date: 2019-09-18T00:08:16+05:00
draft: true
toc: false
images:
tags:
  - hacks
  - holiday
---

## About

### Идея

Поучаствовать в инженерном хакатоне, это одно. А включить своё
творчество на полный максимум – это другое. “Автоматизируй свой умный
дом” – такое задание предложил нам Яндекс.

### Задача

Придумать устройство, которое могло бы называться умным и связать его с
Яндекс Платформой.

### Рисерч

Наше устройство должно было помочь людям с просыпанием, и мы решили
эту проблему.

## Work

### Начало работы

Как обычно, мы сначала спроектировали свой проект, который назвали
“Умная Штора”. Нашли гардину, нашли шторы, и начали брейншторм.
Получив некоторое представление штор, начали думать о компонентах.

Вначале, нам показалось, что четырёх моторов должно хватить. Хотели их
подключить к реле питания, и управлять непосредственно реле, но такой
подход оказался более затратным, чем придумать блок, который менял бы
направление движением.

В итоге наш механизм работал от двух двигателей, которые двигались в
разные стороны, за счёт микросхемы – 2H мост. Но конечный продукт мы
видели с тросами, которые наматываются на втулку, закрепленную на
двигателе постоянного тока.

### Описание работы шторы
В идеале наша система работала с двумя двигателями постоянного тока и
тросами, которые закреплены на втулках(шкивах). Самый простой механизм
– “Связываем кольцо шторы, которое ближе к середине с тросом и управляем
непосредственно ей”. Первый прототип работал именно так, по таймеру. То есть двигатель знал, что четыре секунды – достаточно для открывания шторы, в обоих направлениях.

### Проектирование в CAD системах:

После того, как мы поняли, что нам необходимо всего два мотора, мы
задались мыслью, а как же наши моторы будут держаться на гардине?
Недолго думая, решили напечатать на 3D принтере какой-нибудь держатель
для двигателя. Держатели выполнены в двух частях. 

*Большая сторона* –
крепится к мотору и гардине, 

*меньшая* – клеится с другой стороны держателя
на гардину. 

Получив первые схемы, мы начали проектировать шкив, на
который наматывается трос. Поскольку 3D принтер отказывался печатать
крепление, мы быстро нашли лазерный станок с ЧПУ, и отправились резать
оргстекло, чтобы получить крепления быстрее и качественней. После
получения восьми пластин, мы их склеили “самым обычным клеем” придав дополнительной жесткости конструкции. 

Осталось придумать замену
втулкам, которые крепились на вал двигателя, и здесь нам помог ремешок.

Устройство крепления штор
![](https://i.ibb.co/mD2xJN1/001.png)

Нижний зажим для креплений
![](https://i.ibb.co/tZsSsXV/002.png)

Шкив (втулка) для двигателя
![](https://i.ibb.co/r420ysw/003.png)

Крепление свободных блоков
![](https://i.ibb.co/0h0SV4K/004.png)

### Первое изменение в проекте

Мы поняли, что велосипедная цепь – самая удобная вещь в использовании штор. Отправились в самый огромный магазин, купили четыре металлических шкива, два из которых были меньшего диаметра и крепились непосредственно на вал электродвигателя. Теперь наше кольцо по гардине двигалась за счет зубчатого ремня, которое мы приобрели там же.

### Принципиальная схема работа электроники

Как обычно мы выбрали мозг нашей рабочей схемы – Arduino

В нашем комплекте:

* x1 Arduino Nano
* x1 Node MCU v2 (Wi-Fi adapter)
* x2 Моторы постоянного тока
* x4 Герконы на размыкание
* x4 Резисторы 100кОМ
* x1 Схема драйвера – L293D
* x1 Корпус, который могли найти в канцелярском магазине
* x0 И очень, очень много проводов

### Работа выглядит следующим образом.
1. Каждые несколько секунд плата NodeMCU по WI-FI (Polling) собирает
данные с сервера, и проверяет, не изменилось ли состояние шторы. Если
изменилось, то запоминаем и отправляем по Serial порту на обработку в плату Arduino Nano, которая изначально работает в режиме 3.
2. После получения команды open/close, плата начинает движение обоими
моторами (режим работы 1 или 2), до тех пор, пока не встретит магнитный
размыкатель цепи (Геркон), данные которого собираются на аналоговых портах
3. После данного этого, моторы постепенно замедляются, и останавливаются. Сама плата переходит в режим 3 – прием сообщений

### Интернет провод с Герконами:

Поскольку схема работы герконов очень простая, но требует затрат на провода, мы пошли искать провод с шестью жилами, то есть в одном проводе протекает шесть небольших проводов. Таким образом мы смогли применить самый стандартный Ethernet провод, в котором у нас насчитывалось целых восемь
жил.

Схема для платы Arduino UNO и Wi-Fi модуля
![](https://i.ibb.co/XF7kJ8D/005.png)

Схема для платы Arduino UNO и Герконов
![](https://i.ibb.co/fkQggT4/006.png)

## Product

![](https://russu.xyz/static/media/10.c2ac659a.png)

[Промо-страница](https://yandex.ru/promo/events/hardware)

[Видео работы прототипа](https://yadi.sk/d/pPFHUXqb3bLucg) 

[Конференция Я.Железо](https://youtu.be/ewXwGFaaaZg?t=949)

[GitLab](https://gitlab.com/gabenD/yandex_code_hack)