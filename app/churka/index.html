<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –ü–æ–ª–∏—Ü–µ–π—Å–∫–æ–π –î–µ–≤—É—à–∫–∏!</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        /* –£–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª */
        font-family: Arial, sans-serif;
        background-color: black;
        /* –¢—ë–º–Ω—ã–π —Ñ–æ–Ω */
        color: #ffffff;
        /* –ë–µ–ª—ã–π —Ç–µ–∫—Å—Ç */
        text-align: center;
      }

      h1 {
        color: #ff4081;
        /* –†–æ–∑–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        margin-top: 20px;
      }

      .game {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        /* –ù–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */
      }

      .game-wrapper {
        width: auto;
        z-index: 9999;
      }

      button {
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        background-color: #ff4081;
        /* –†–æ–∑–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ */
        color: #fff;
        border: none;
        border-radius: 5px;
        margin-top: 20px;
        transition: background-color 0.3s ease;
      }

      button:hover {
        background-color: #e91e63;
        /* –¢–µ–º–Ω–µ–µ —Ä–æ–∑–æ–≤—ã–π –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
      }

      .hidden {
        display: none;
      }

      #gameCanvas {
        display: block;
        background-color: #2c2c2c;
        /* –¢—ë–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è canvas */
        border-radius: 10px;
        width: 50vw;
        /* 50% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ */
        height: 50vh;
        /* 50% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞ */
      }

      .video-container {
        margin-top: 20px;
      }

      video {
        width: 100%;
        height: auto;
        max-width: 800px;
        border-radius: 10px;
      }

      .counter {
        margin-top: 10px;
        font-size: 18px;
        color: #ff4081;
      }
    </style>
  </head>
  <body>
    <div class="game">
      <div class="game-wrapper">
        <h1 onClick="confetti()" style="cursor:pointer">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å 22-–ª–µ—Ç–∏–µ–º!</h1>
        <p>–î–æ—Ä–æ–≥–∞—è –ø–æ–ª–∏—Ü–µ–π—Å–∫–∞—è –¥–µ–≤—É—à–∫–∞, —Å–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π –¥–µ–Ω—å! üéâ</p>
        <p>–ü–æ–π–º–∞–π –≤—Å–µ—Ö –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤!</p>
        <div id="game-content">
          <button onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        </div>
        <div id="canvas-container" class="hidden">
          <canvas id="gameCanvas"></canvas>
          <div id="counter" class="counter"></div>
          <!-- –°—á—ë—Ç—á–∏–∫ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤ -->
        </div>
        <div id="end-game" class="hidden">
          <h2>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, —Ç—ã –ø—Ä–æ—à–ª–∞ –∏–≥—Ä—É! üéâ</h2>
          <button onclick="showGift()">–ü—Ä–∏–Ω—è—Ç—å –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
        </div>
        <div id="video-container" class="hidden video-container">
          <video id="video" autoplay controls loop>
            <source src="congratulations.mp4" type="video/mp4"> –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
          </video>
        </div>
      </div>
    </div>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É js-confetti -->
    <script src="https://cdn.jsdelivr.net/npm/js-confetti@0.9.0/dist/js-confetti.browser.js"></script>
    <script>
      const minCriminals = 3;
      const maxCriminals = 5;
      const gameCanvas = document.getElementById('gameCanvas');
      const ctx = gameCanvas.getContext('2d');
      const counterElement = document.getElementById('counter'); // –≠–ª–µ–º–µ–Ω—Ç —Å—á—ë—Ç—á–∏–∫–∞
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
      gameCanvas.width = window.innerWidth * 0.5; // 50% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞
      gameCanvas.height = window.innerHeight * 0.5; // 50% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞
      let isGameStarted = false;
      let police = {
        x: 50,
        y: 50,
        size: 40
      }; // –ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
      let criminals = []; // –ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∏
      const policeSpeed = 8; // –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–≥–æ
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è js-confetti —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º jsConfettiCanvas
      const jsConfetti = new JSConfetti();
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      const policeImage = new Image();
      policeImage.src = 'police.png'; // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–≥–æ
      const catImage = new Image();
      catImage.src = 'cat.png'; // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –∫–æ—Ç–∞
      // –°–æ–∑–¥–∞—ë–º –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤
      function createCriminals() {
        const count = Math.floor(Math.random() * (maxCriminals - minCriminals + 1)) + minCriminals;
        for (let i = 0; i < count; i++) {
          criminals.push({
            x: Math.random() * gameCanvas.width,
            y: Math.random() * gameCanvas.height,
            size: 30, // –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ç–∞
            caught: false,
            dx: (Math.random() - 0.5) * 4, // –°–ª—É—á–∞–π–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ X
            dy: (Math.random() - 0.5) * 4, // –°–ª—É—á–∞–π–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ Y
          });
        }
      }
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤
      function updateCounter() {
        const remaining = criminals.filter(c => !c.caught).length;
        counterElement.textContent = `–û—Å—Ç–∞–ª–æ—Å—å –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤: ${remaining}`;
      }

      function startGame() {
        document.getElementById('game-content').classList.add('hidden');
        document.getElementById('canvas-container').classList.remove('hidden');
        isGameStarted = true;
        criminals = []; // –û—á–∏—â–∞–µ–º –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤
        createCriminals(); // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã—Ö –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤
        updateCounter(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫
        animate();
      }

      function drawPolice() {
        // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª–∏—Ü–µ–π—Å–∫–æ–≥–æ
        ctx.drawImage(policeImage, police.x - police.size / 2, // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
          police.y - police.size / 2, police.size, police.size);
      }

      function drawCriminals() {
        criminals.forEach(criminal => {
          if (!criminal.caught) {
            // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ç–∞
            ctx.drawImage(catImage, criminal.x - criminal.size / 2, // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
              criminal.y - criminal.size / 2, criminal.size, criminal.size);
          }
        });
      }

      function moveCriminals() {
        criminals.forEach(criminal => {
          if (!criminal.caught) {
            criminal.x += criminal.dx;
            criminal.y += criminal.dy;
            // –û—Ç—Å–∫–æ–∫ –æ—Ç –≥—Ä–∞–Ω–∏—Ü canvas
            if (criminal.x < criminal.size || criminal.x > gameCanvas.width - criminal.size) {
              criminal.dx *= -1;
            }
            if (criminal.y < criminal.size || criminal.y > gameCanvas.height - criminal.size) {
              criminal.dy *= -1;
            }
          }
        });
      }

      function checkCollision() {
        criminals.forEach(criminal => {
          if (!criminal.caught) {
            const distance = Math.sqrt((police.x - criminal.x) ** 2 + (police.y - criminal.y) ** 2);
            if (distance < police.size / 2 + criminal.size / 2) {
              criminal.caught = true; // –ü—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –ø–æ–π–º–∞–Ω
              updateCounter(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫
            }
          }
        });
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–∏ –ø–æ–π–º–∞–Ω—ã
        if (criminals.every(c => c.caught)) {
          endGame();
        }
      }

      function confetti() {
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
        jsConfetti.addConfetti({
          emojis: ['üéâ', 'üéä', '‚ú®', 'ü•≥', 'üéà'],
          emojiSize: 50,
          confettiNumber: 100,
        });
      }

      function endGame() {
        isGameStarted = false;
        document.getElementById('canvas-container').classList.add('hidden');
        document.getElementById('end-game').classList.remove('hidden');
        confetti();
      }

      function animate() {
        if (!isGameStarted) return;
        ctx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
        drawPolice();
        drawCriminals();
        moveCriminals();
        checkCollision();
        requestAnimationFrame(animate);
      }

      function showGift() {
        document.getElementById('end-game').classList.add('hidden');
        document.getElementById('video-container').classList.remove('hidden');
        const video = document.getElementById('video');
        video.play(); // –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ
      }
      // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–º
      window.addEventListener('keydown', (e) => {
        if (!isGameStarted) return;
        switch (e.key) {
          case 'ArrowUp':
            police.y = Math.max(police.y - policeSpeed, police.size / 2);
            break;
          case 'ArrowDown':
            police.y = Math.min(police.y + policeSpeed, gameCanvas.height - police.size / 2);
            break;
          case 'ArrowLeft':
            police.x = Math.max(police.x - policeSpeed, police.size / 2);
            break;
          case 'ArrowRight':
            police.x = Math.min(police.x + policeSpeed, gameCanvas.width - police.size / 2);
            break;
        }
      });
    </script>
  </body>
</html>